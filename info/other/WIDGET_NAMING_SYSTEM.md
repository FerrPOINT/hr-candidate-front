# Система переименования виджетов

## Обзор

Система переименования виджетов позволяет пользователям давать уникальные имена каждому виджету на странице. Имена сохраняются как локально для каждого виджета, так и глобально для типа виджета.

## Возможности

### 1. Двойной клик для переименования
- Двойной клик по заголовку виджета открывает поле редактирования
- Поддерживает клавиши Enter (сохранить) и Escape (отмена)
- Автоматическое сохранение при потере фокуса

### 2. Редактирование в правой панели
- Поле "Название виджета" в правой панели
- Реальное время обновления
- Подсказка о двойном клике

### 3. Глобальные настройки имен
- Имена сохраняются в глобальном store
- Новые виджеты этого типа получают сохраненное имя
- Возможность сброса настроек

### 4. Отображение имен
- Заголовки виджетов показывают имена
- Список виджетов в левой панели
- Панель настроек с именами

## Архитектура

### 1. WidgetHeader Component
```typescript
interface WidgetHeaderProps {
  componentId: string;
  pageId: string;
  name?: string;
  type: string;
  isSelected: boolean;
  onSelect: () => void;
}
```

**Функции:**
- Отображение имени виджета
- Обработка двойного клика
- Редактирование имени
- Интеграция с глобальными настройками

### 2. Интеграция с PagesStore
- Поле `name` в интерфейсе `Component`
- Автоматическая генерация имен по умолчанию
- Копирование имен при дублировании

### 3. Интеграция с WidgetSettingsStore
- Сохранение имен в глобальных настройках
- Применение глобальных имен к новым виджетам
- Приоритет: локальное имя > глобальное имя > тип виджета

## Использование

### Переименование через двойной клик
1. Выберите виджет на холсте
2. Двойной клик по заголовку виджета
3. Введите новое имя
4. Нажмите Enter или кликните вне поля

### Переименование через правую панель
1. Выберите виджет
2. В правой панели найдите поле "Название виджета"
3. Введите новое имя
4. Имя сохраняется автоматически

### Управление глобальными именами
1. Нажмите кнопку ⚙️ в левой панели
2. Просмотрите сохраненные имена
3. Сбросьте имена для конкретных типов виджетов

## Генерация имен по умолчанию

### Приоритет имен:
1. **Локальное имя** - если виджет уже имеет имя
2. **Глобальное имя** - из настроек для этого типа виджета
3. **DisplayName** - из конфигурации компонента в LeftPanel
4. **Автогенерация** - `{тип} {timestamp}`

### При дублировании:
- Исходное имя + " (копия)"
- Пример: "Список вакансий (копия)"

## UI/UX особенности

### Заголовок виджета
- Показывает имя и тип виджета
- Индикатор выбора
- Иконка редактирования для выбранного виджета
- Подсказки при наведении

### Поле редактирования
- Автофокус и выделение текста
- Кнопки "Сохранить" и "Отмена"
- Ограничение длины (50 символов)
- Валидация пустых имен

### Интеграция с существующим UI
- Совместимость с drag & drop
- Сохранение функциональности кнопок управления
- Адаптация к различным размерам виджетов

## Технические детали

### Сохранение данных
```typescript
// Локальное сохранение
updateComponent(pageId, componentId, { name: newName });

// Глобальное сохранение
updateWidgetSetting(type, 'name', newName);
```

### Загрузка данных
```typescript
// Приоритет загрузки
const displayName = component.name || globalSettings.name || component.type;
```

### Валидация
- Минимальная длина: 1 символ
- Максимальная длина: 50 символов
- Автоматическая обрезка пробелов
- Запрет пустых имен

## Преимущества

1. **Удобство**: Быстрое переименование через двойной клик
2. **Гибкость**: Два способа редактирования
3. **Консистентность**: Глобальные настройки имен
4. **Производительность**: Оптимизированное обновление UI
5. **Доступность**: Поддержка клавиатурной навигации
6. **Интеграция**: Полная совместимость с существующей системой 